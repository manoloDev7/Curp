<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulario</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
      * {
        margin: 0%;
        padding: 0%;
        box-sizing: border-box;
      }
      body {
        background-color: hsl(0, 0%, 87%);
        display: flex;

        justify-content: center;
      }
      form {
        margin-top: 90px;
        padding: 28px;
        display: flex;
        flex-direction: column;
        background-color: hsl(0, 0%, 94%);
        border-radius: 0.7em;
        width: 37%;
        height: 630px;
        box-shadow: 0px 2px 2px 2px hsl(0, 0%, 80%);
      }
      form button {
        margin-left: 95px;
      }
      form label,
      h1,
      input {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue",
          sans-serif;
        padding: 10px;
      }

      label {
        font-size: larger;
      }
      input {
        border-radius: 0.5em;
        border: 0.1px inset hsl(0, 0%, 50%);
        margin-bottom: 5px;
      }
      button {
        padding: 10px;
        margin-top: 30px;
        border-radius: 0.7em;
        background-color: hsl(0, 0%, 100%);
        color: #000;
        font-size: large;
        width: 60%;
        border: none;
        box-shadow: 0px 2px 2px 2px hsl(0, 0%, 85%);
      }
      button:hover {
        background-color: hsl(0, 0%, 97%);
      }
      h1 {
        color: hsl(0, 0%, 1%);
      }
      label {
        color: hsl(0, 0%, 35%);
      }
    </style>
  </head>
  <body>
    <form id="formulario" enctype="multipart/form-data">
      <h1>Ingrese su informacion personal</h1>
      <label for="">Ingrese su nombre</label>
      <input
        type="text"
        name="nombre"
        id="nombre"
        placeholder="Ej: Manolo"
        required
      />

      <label for="">Ingrese su apellido</label>
      <input
        type="text"
        name="apellido"
        id="apellido"
        placeholder="Ej: Cisneros"
        required
      />

      <label for="">Ingrese su email</label>
      <input
        type="email"
        name="email"
        id="email"
        placeholder="Ej: manolo23423@gmail.com"
        required
      />

      <label for="">Ingrese su contasena</label>
      <input
        type="password"
        name="password"
        id="password"
        placeholder=""
        required
      />

      <div>
        <label for="">Genero</label>
        <select name="genero" id="genero" required>
          <option value="hombre">Hombre</option>
          <option value="mujer">Mujer</option>
          <option value="otro">Otro</option>
        </select>
      </div>

      <input type="file" name="foto" id="foto" accept="image/png, image/jpeg" />
      <button type="submit">Enviar</button>
    </form>

    <script>
      const formulario = document.getElementById("formulario");

      formulario.addEventListener("submit", async (event) => {
        event.preventDefault();

        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        const nombre = document.getElementById("nombre").value;
        const ape = document.getElementById("apellido").value;
        const corre = document.getElementById("email").value;
        const ps = document.getElementById("password").value;
        const gn = document.getElementById("genero").value;
        const fotoInput = document.getElementById("foto");

        doc.text("InformaciÃ³n del formulario:", 5, 10);
        doc.text(`Nombre: ${nombre}`, 5, 20);
        doc.text(`Apellido: ${ape}`, 5, 30);
        doc.text(`Email: ${corre}`, 5, 40);
        doc.text(`Contrasena: ${ps}`, 5, 50);
        doc.text(`Genero: ${gn}`, 5, 60);
        let yAfterText = 70;

        if (fotoInput.files.length > 0) {
          try {
            const file = fotoInput.files[0];
            const formato = file.type === "image/png" ? "PNG" : "JPEG";
            const imgData = await leerArchivoComoDataURL(file);
            doc.addImage(imgData, formato, 5, yAfterText, 60, 0);
          } catch (error) {
            doc.text("No se pudo cargar la foto.", 5, yAfterText);
          }
        } else {
          doc.text("No se ha seleccionado ninguna foto.", 5, yAfterText);
        }

        doc.save("formularioINfo.pdf");
      });

      function leerArchivoComoDataURL(file) {
        return new Promise((resolve, reject) => {
          const reader = new FileReader();
          reader.onload = (event) => resolve(event.target.result);
          reader.onerror = () =>
            reject(new Error("Error al leer el archivo adjunto."));
          reader.readAsDataURL(file);
        });
      }
    </script>
  </body>
</html>
